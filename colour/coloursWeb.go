package colour

import (
	"fmt"
	"image/color" //nolint:misspell
)

//nolint:mnd
var (
	webColours = colourNameToRGBA{
		"white":   {R: 0xFF, G: 0xFF, B: 0xFF, A: 0xFF},
		"silver":  {R: 0xC0, G: 0xC0, B: 0xC0, A: 0xFF},
		"gray":    {R: 0x80, G: 0x80, B: 0x80, A: 0xFF},
		"grey":    {R: 0x80, G: 0x80, B: 0x80, A: 0xFF},
		"black":   {R: 0x00, G: 0x00, B: 0x00, A: 0xFF},
		"red":     {R: 0xFF, G: 0x00, B: 0x00, A: 0xFF},
		"maroon":  {R: 0x80, G: 0x00, B: 0x00, A: 0xFF},
		"yellow":  {R: 0xFF, G: 0xFF, B: 0x00, A: 0xFF},
		"olive":   {R: 0x80, G: 0x80, B: 0x00, A: 0xFF},
		"lime":    {R: 0x00, G: 0xFF, B: 0x00, A: 0xFF},
		"green":   {R: 0x00, G: 0x80, B: 0x00, A: 0xFF},
		"aqua":    {R: 0x00, G: 0xFF, B: 0xFF, A: 0xFF},
		"teal":    {R: 0x00, G: 0x80, B: 0x80, A: 0xFF},
		"blue":    {R: 0x00, G: 0x00, B: 0xFF, A: 0xFF},
		"navy":    {R: 0x00, G: 0x00, B: 0x80, A: 0xFF},
		"fuchsia": {R: 0xFF, G: 0x00, B: 0xFF, A: 0xFF},
		"purple":  {R: 0x80, G: 0x00, B: 0x80, A: 0xFF},
	}

	cgaColours = colourNameToRGBA{
		"white":        {R: 0xFF, G: 0xFF, B: 0xFF, A: 0xFF},
		"light gray":   {R: 0xC0, G: 0xC0, B: 0xC0, A: 0xFF},
		"light grey":   {R: 0xC0, G: 0xC0, B: 0xC0, A: 0xFF},
		"dark gray":    {R: 0x80, G: 0x80, B: 0x80, A: 0xFF},
		"dark grey":    {R: 0x80, G: 0x80, B: 0x80, A: 0xFF},
		"black":        {R: 0x00, G: 0x00, B: 0x00, A: 0xFF},
		"high red":     {R: 0xFF, G: 0x00, B: 0x00, A: 0xFF},
		"low red":      {R: 0x80, G: 0x00, B: 0x00, A: 0xFF},
		"yellow":       {R: 0xFF, G: 0xFF, B: 0x00, A: 0xFF},
		"brown":        {R: 0x80, G: 0x80, B: 0x00, A: 0xFF},
		"high green":   {R: 0x00, G: 0xFF, B: 0x00, A: 0xFF},
		"green":        {R: 0x00, G: 0xFF, B: 0x00, A: 0xFF},
		"low green":    {R: 0x00, G: 0x80, B: 0x00, A: 0xFF},
		"high cyan":    {R: 0x00, G: 0xFF, B: 0xFF, A: 0xFF},
		"cyan":         {R: 0x00, G: 0xFF, B: 0xFF, A: 0xFF},
		"low cyan":     {R: 0x00, G: 0x80, B: 0x80, A: 0xFF},
		"high blue":    {R: 0x00, G: 0x00, B: 0xFF, A: 0xFF},
		"low blue":     {R: 0x00, G: 0x00, B: 0x80, A: 0xFF},
		"high magenta": {R: 0xFF, G: 0x00, B: 0xFF, A: 0xFF},
		"magenta":      {R: 0xFF, G: 0x00, B: 0xFF, A: 0xFF},
		"low magenta":  {R: 0x80, G: 0x00, B: 0x80, A: 0xFF},
	}

	cgaColoursByNum = map[int]rgba{
		15: {R: 0xFF, G: 0xFF, B: 0xFF, A: 0xFF},
		7:  {R: 0xC0, G: 0xC0, B: 0xC0, A: 0xFF},
		8:  {R: 0x80, G: 0x80, B: 0x80, A: 0xFF},
		0:  {R: 0x00, G: 0x00, B: 0x00, A: 0xFF},
		12: {R: 0xFF, G: 0x00, B: 0x00, A: 0xFF},
		4:  {R: 0x80, G: 0x00, B: 0x00, A: 0xFF},
		14: {R: 0xFF, G: 0xFF, B: 0x00, A: 0xFF},
		6:  {R: 0x80, G: 0x80, B: 0x00, A: 0xFF},
		10: {R: 0x00, G: 0xFF, B: 0x00, A: 0xFF},
		2:  {R: 0x00, G: 0x80, B: 0x00, A: 0xFF},
		11: {R: 0x00, G: 0xFF, B: 0xFF, A: 0xFF},
		3:  {R: 0x00, G: 0x80, B: 0x80, A: 0xFF},
		9:  {R: 0x00, G: 0x00, B: 0xFF, A: 0xFF},
		1:  {R: 0x00, G: 0x00, B: 0x80, A: 0xFF},
		13: {R: 0xFF, G: 0x00, B: 0xFF, A: 0xFF},
		5:  {R: 0x80, G: 0x00, B: 0x80, A: 0xFF},
	}
)

// CGAColour returns the CGA colour corresponding to the given int. If the
// colour is not found then a non-nil error is returned.
func CGAColour(i int) (color.RGBA, error) { //nolint:misspell
	if c, ok := cgaColoursByNum[i]; ok {
		return c, nil
	}

	return rgba{}, fmt.Errorf("bad CGA colour index: %d", i)
}
